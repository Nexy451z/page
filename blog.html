<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nex / Blog</title>
    <style>
        /* =========================================
           1. 設定 & 基本スタイル
           ========================================= */
        :root {
            --color-main: #ffffff;
            --color-bg: #050505;
            --color-sub: #888888;
            --color-border: #333333;
            --font-family: 'Courier New', Courier, monospace;
            --panel-width: 600px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background-color: var(--color-bg);
            color: var(--color-main);
            font-family: var(--font-family);
            min-height: 100vh;
            overflow-x: hidden; /* 横スクロール防止 */
        }

        /* ノイズ背景 */
        body::after {
            content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
            pointer-events: none; z-index: 0;
        }

        /* =========================================
           2. メインコンテンツエリア
           ========================================= */
        .container {
            position: relative; z-index: 10;
            max-width: 800px; margin: 0 auto; padding: 2rem 1.5rem;
            transition: filter 0.3s;
        }
        /* パネルが開いたらメイン画面を少し暗くぼかす */
        body.panel-open .container {
            filter: blur(3px) brightness(0.4);
            pointer-events: none; /* 奥のクリック無効化 */
        }

        /* ヘッダー */
        header {
            margin-bottom: 4rem; border-bottom: 1px solid var(--color-border);
            padding-bottom: 1rem; display: flex; justify-content: space-between; align-items: flex-end;
        }
        .page-title { font-size: 1.5rem; font-weight: bold; }
        .page-title span { color: var(--color-sub); }
        .back-link { text-decoration: none; color: var(--color-sub); font-size: 0.9rem; transition: color 0.3s; }
        .back-link:hover { color: var(--color-main); }

        /* 記事リスト */
        .post-list { display: flex; flex-direction: column; gap: 2rem; }

        .post-card {
            cursor: pointer;
            display: block; text-decoration: none; color: var(--color-main);
            background: rgba(255, 255, 255, 0.02); border: 1px solid var(--color-border);
            padding: 1.5rem; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            /* 出現アニメーション */
            opacity: 0; transform: translateY(20px); animation: fadeInUp 0.6s forwards;
        }
        .post-card:hover {
            background: rgba(255, 255, 255, 0.08); border-color: var(--color-main);
            transform: translateY(-2px) scale(1.01);
        }

        .post-meta { font-size: 0.8rem; color: var(--color-sub); margin-bottom: 0.5rem; display: flex; gap: 1rem; }
        .tag { border: 1px solid #444; padding: 2px 6px; font-size: 0.7rem; }
        .post-title { font-size: 1.2rem; margin-bottom: 0.8rem; font-weight: bold; }
        .post-excerpt { font-size: 0.9rem; color: #ccc; line-height: 1.6; }
        .read-more { margin-top: 1rem; font-size: 0.8rem; color: var(--color-main); display: inline-block; border-bottom: 1px solid transparent; }

        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
        .post-card:nth-child(1) { animation-delay: 0.1s; }
        .post-card:nth-child(2) { animation-delay: 0.2s; }
        .post-card:nth-child(3) { animation-delay: 0.3s; }

        /* =========================================
           3. スライドパネル (記事表示部)
           ========================================= */
        #side-panel {
            position: fixed; top: 0; right: 0;
            width: var(--panel-width); max-width: 100%; height: 100%;
            background: #0a0a0a;
            border-left: 1px solid var(--color-border);
            z-index: 100;
            transform: translateX(100%); /* 初期は右に隠す */
            transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
            box-shadow: -10px 0 30px rgba(0,0,0,0.8);
            display: flex; flex-direction: column; /* 縦並びレイアウト */
        }
        #side-panel.open { transform: translateX(0); }

        /* パネル上部 */
        .panel-header {
            padding: 1rem 1.5rem; border-bottom: 1px solid var(--color-border);
            display: flex; justify-content: flex-end; background: rgba(0,0,0,0.8);
        }
        .close-btn {
            background: none; border: 1px solid var(--color-sub); color: var(--color-main);
            padding: 5px 10px; cursor: pointer; font-family: var(--font-family); transition: 0.3s;
        }
        .close-btn:hover { background: var(--color-main); color: var(--color-bg); }

        /* 記事本文エリア */
        #panel-content {
            padding: 2rem 2rem 4rem 2rem;
            overflow-y: auto; flex-grow: 1; /* 残りの高さを埋める */
            line-height: 1.8; font-size: 0.95rem;
        }

        /* =========================================
           4. パネル下部ナビゲーション (◀ ■ ▶)
           ========================================= */
        .panel-footer {
            margin-top: auto; /* 一番下に固定 */
            border-top: 1px solid var(--color-border);
            background: rgba(0,0,0,0.9);
            display: flex; justify-content: space-between; align-items: stretch;
            height: 60px;
        }

        .nav-btn {
            flex: 1; display: flex; align-items: center; justify-content: center;
            cursor: pointer; color: var(--color-sub); transition: all 0.3s;
            position: relative; overflow: visible; /* ツールチップ表示用 */
            font-size: 1.2rem; user-select: none;
        }
        .nav-btn:hover { background: rgba(255,255,255,0.1); color: var(--color-main); }
        
        /* 真ん中の閉じるボタン */
        .nav-btn.home-btn {
            flex: 0 0 80px; border-left: 1px solid #222; border-right: 1px solid #222; font-size: 1.5rem;
        }

        /* 無効状態（前/次の記事がない時） */
        .nav-btn.disabled { opacity: 0.2; pointer-events: none; }

        /* ツールチップ（次の記事タイトルなど） */
        .nav-label {
            position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%);
            background: var(--color-main); color: var(--color-bg);
            padding: 4px 8px; font-size: 0.7rem; white-space: nowrap;
            opacity: 0; pointer-events: none; transition: opacity 0.3s; margin-bottom: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        .nav-btn:hover .nav-label { opacity: 1; }

        /* オーバーレイ（背景の暗幕） */
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.01); z-index: 90; display: none;
        }
        #overlay.active { display: block; }
        
        /* ローディング表示 */
        .loading { color: var(--color-sub); text-align: center; margin-top: 2rem; }
        .blink { animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0; } }

    </style>
</head>
<body>

    <div class="container">
        <header>
            <div class="page-title">Nex <span>/ blog</span></div>
            <a href="index.html" class="back-link">[ cd .. ]</a>
        </header>

        <div class="post-list">
            <!-- 
              【重要】data-url に記事ファイルのパスを書いてください 
               pages/post1.html など
            -->
            
            <!-- 記事 1 -->
            <div class="post-card" data-url="pages/css-shapes.html">
                <div class="post-meta"><span class="date">2025-05-20</span><span class="tag">DEV</span></div>
                <h2 class="post-title">Pure CSS Visual Experiments</h2>
                <p class="post-excerpt">WebGLや外部ライブラリに依存せず、標準機能のみで描画された幾何学デザインの実験。軽量かつ高パフォーマンスなレンダリングテスト。</p>
                <span class="read-more">Read protocol_ &gt;</span>
            </div>

        </div>

        <footer>&copy; Nex System Log.</footer>
    </div>

    <!-- スライドパネル -->
    <div id="overlay"></div>
    <div id="side-panel">
        <!-- 右上の閉じるボタン -->
        <div class="panel-header">
            <button class="close-btn" id="topCloseBtn">[ CLOSE X ]</button>
        </div>
        
        <!-- 記事表示エリア -->
        <div id="panel-content"></div>

        <!-- 下部ナビゲーション -->
        <div class="panel-footer">
            <div class="nav-btn" id="btnPrev">
                ◀
                <span class="nav-label" id="labelPrev">PREV</span>
            </div>
            <div class="nav-btn home-btn" id="btnCloseFooter">
                ■
            </div>
            <div class="nav-btn" id="btnNext">
                ▶
                <span class="nav-label" id="labelNext">NEXT</span>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        const cards = Array.from(document.querySelectorAll('.post-card'));
        const panel = document.getElementById('side-panel');
        const content = document.getElementById('panel-content');
        const overlay = document.getElementById('overlay');
        const body = document.body;

        // ナビゲーション用
        const btnPrev = document.getElementById('btnPrev');
        const btnNext = document.getElementById('btnNext');
        const labelPrev = document.getElementById('labelPrev');
        const labelNext = document.getElementById('labelNext');

        let currentIndex = -1;

        // 初期化: 各カードにクリックイベント付与
        cards.forEach((card, index) => {
            card.addEventListener('click', () => openPanel(index));
        });

        // パネルを開く
        function openPanel(index) {
            currentIndex = index;
            const url = cards[index].getAttribute('data-url');

            // UI状態変更
            content.innerHTML = '<div class="loading">> Accessing Data...<br><span class="blink">_</span></div>';
            panel.classList.add('open');
            overlay.classList.add('active');
            body.classList.add('panel-open');

            // 前後のボタン更新
            updateNavigation();

            // HTML取得
            fetch(url)
                .then(res => {
                    if (!res.ok) throw new Error('Page not found');
                    return res.text();
                })
                .then(html => {
                    setTimeout(() => {
                        content.innerHTML = html;
                        content.scrollTop = 0; // スクロールリセット
                    }, 300);
                })
                .catch(err => {
                    content.innerHTML = '<p style="color:red; margin-top:20px;">> Error: 記事ファイルが見つかりません。<br>(' + url + ')</p>';
                });
        }

        // ナビゲーションボタンの更新処理
        function updateNavigation() {
            // [前の記事] 設定
            if (currentIndex > 0) {
                const prevCard = cards[currentIndex - 1];
                const title = prevCard.querySelector('.post-title').innerText;
                
                btnPrev.classList.remove('disabled');
                labelPrev.innerText = title;
                btnPrev.onclick = () => openPanel(currentIndex - 1);
            } else {
                btnPrev.classList.add('disabled');
                btnPrev.onclick = null;
            }

            // [次の記事] 設定
            if (currentIndex < cards.length - 1) {
                const nextCard = cards[currentIndex + 1];
                const title = nextCard.querySelector('.post-title').innerText;
                
                btnNext.classList.remove('disabled');
                labelNext.innerText = title;
                btnNext.onclick = () => openPanel(currentIndex + 1);
            } else {
                btnNext.classList.add('disabled');
                btnNext.onclick = null;
            }
        }

        // 閉じる処理
        function closePanel() {
            panel.classList.remove('open');
            overlay.classList.remove('active');
            body.classList.remove('panel-open');
        }

        // イベントリスナー
        document.getElementById('topCloseBtn').addEventListener('click', closePanel);
        document.getElementById('btnCloseFooter').addEventListener('click', closePanel);
        overlay.addEventListener('click', closePanel);
    </script>
</body>
</html>
